
// SS FASHION HOUSE - E-commerce Website with Order Sorting by Date Added
import React, { useState } from "react";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectTrigger, SelectContent, SelectItem } from "@/components/ui/select";

export default function Home() {
  const [products, setProducts] = useState([
    {
      id: 1,
      name: "Stylish Kurti",
      description: "Comfortable and elegant design",
      price: "à§³950",
      image: "https://via.placeholder.com/300x300.png?text=Kurti"
    }
  ]);

  const [orders, setOrders] = useState([]);
  const [orderInfo, setOrderInfo] = useState({ name: '', phone: '', trxId: '', product: '', paymentMethod: '', paid: false, confirmed: false });
  const [newProduct, setNewProduct] = useState({ name: '', description: '', price: '', image: '' });

  const handleOrderChange = (e) => {
    setOrderInfo({ ...orderInfo, [e.target.name]: e.target.value });
  };

  const handlePaymentMethodChange = (value) => {
    setOrderInfo({ ...orderInfo, paymentMethod: value });
  };

  const handleOrderSubmit = () => {
    const timestamp = new Date().toISOString();
    setOrders([{ ...orderInfo, date: timestamp, paid: orderInfo.paymentMethod === "Cash on Delivery" ? false : true, confirmed: false }, ...orders]);
    alert("Order placed successfully!");
    setOrderInfo({ name: '', phone: '', trxId: '', product: '', paymentMethod: '', paid: false, confirmed: false });
  };

  const handleDeleteOrder = (index) => {
    const updated = [...orders];
    updated.splice(index, 1);
    setOrders(updated);
  };

  const togglePaymentStatus = (index) => {
    const updated = [...orders];
    updated[index].paid = !updated[index].paid;
    setOrders(updated);
  };

  const toggleConfirmation = (index) => {
    const updated = [...orders];
    updated[index].confirmed = !updated[index].confirmed;
    setOrders(updated);
  };

  const downloadOrders = () => {
    const header = "Name,Phone,Product,TrxID,Payment Method,Paid,Confirmed,Date\n";
    const rows = orders.map(o => `${o.name},${o.phone},${o.product},${o.trxId},${o.paymentMethod},${o.paid ? "Yes" : "No"},${o.confirmed ? "Yes" : "No"},${o.date}`).join("\n");
    const csv = header + rows;
    const blob = new Blob([csv], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'order_list.csv';
    a.click();
    URL.revokeObjectURL(url);
  };

  const handleProductChange = (e) => {
    setNewProduct({ ...newProduct, [e.target.name]: e.target.value });
  };

  const handleAddProduct = () => {
    const newId = products.length + 1;
    setProducts([...products, { ...newProduct, id: newId }]);
    setNewProduct({ name: '', description: '', price: '', image: '' });
  };

  return (
    <main className="min-h-screen bg-white text-gray-900 p-4">
      <header className="text-center py-6 border-b border-gray-200">
        <h1 className="text-4xl font-bold text-gold-600">SS FASHION HOUSE</h1>
        <p className="text-sm mt-2">Style That Speaks</p>
      </header>

      <section className="my-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {products.map((product) => (
          <Card key={product.id} className="shadow-xl rounded-2xl overflow-hidden">
            <CardContent className="p-4">
              <img
                src={product.image}
                alt={product.name}
                className="w-full h-auto rounded-xl mb-2"
              />
              <h2 className="text-xl font-semibold">{product.name}</h2>
              <p className="text-sm text-gray-500">{product.description}</p>
              <p className="text-lg font-bold mt-2">{product.price}</p>
              <Button className="mt-3 w-full bg-gold-500 hover:bg-gold-600" onClick={() => setOrderInfo({ ...orderInfo, product: product.name })}>Select</Button>
            </CardContent>
          </Card>
        ))}
      </section>

      <section className="my-12 max-w-xl mx-auto bg-gray-50 p-6 rounded-xl shadow">
        <h2 className="text-2xl font-semibold mb-4">Place Your Order</h2>
        <div className="space-y-4">
          <div>
            <Label>Your Name</Label>
            <Input name="name" value={orderInfo.name} onChange={handleOrderChange} placeholder="Enter your name" />
          </div>
          <div>
            <Label>Phone Number</Label>
            <Input name="phone" value={orderInfo.phone} onChange={handleOrderChange} placeholder="01XXXXXXXXX" />
          </div>
          <div>
            <Label>Transaction ID (if applicable)</Label>
            <Input name="trxId" value={orderInfo.trxId} onChange={handleOrderChange} placeholder="e.g. TX12345ABC" />
          </div>
          <div>
            <Label>Payment Method</Label>
            <Select value={orderInfo.paymentMethod} onValueChange={handlePaymentMethodChange}>
              <SelectTrigger className="w-full">
                {orderInfo.paymentMethod || "Select Method"}
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="bKash">bKash</SelectItem>
                <SelectItem value="Nagad">Nagad</SelectItem>
                <SelectItem value="Rocket">Rocket</SelectItem>
                <SelectItem value="Upay">Upay</SelectItem>
                <SelectItem value="Cash on Delivery">Cash on Delivery</SelectItem>
              </SelectContent>
            </Select>
          </div>
          <div>
            <Label>Selected Product</Label>
            <Input name="product" value={orderInfo.product} readOnly className="bg-gray-100" />
          </div>
          <Button className="w-full bg-green-600 hover:bg-green-700" onClick={handleOrderSubmit}>Submit Order</Button>
        </div>
      </section>

      <section className="my-12 max-w-5xl mx-auto bg-gray-100 p-6 rounded-xl shadow">
        <div className="flex justify-between items-center mb-4">
          <h2 className="text-2xl font-semibold">Order List</h2>
          <Button className="bg-purple-600 hover:bg-purple-700" onClick={downloadOrders}>Download CSV</Button>
        </div>
        {orders.length === 0 ? (
          <p className="text-gray-500">No orders yet.</p>
        ) : (
          <div className="overflow-x-auto">
            <table className="min-w-full text-sm text-left">
              <thead>
                <tr className="border-b font-bold">
                  <th className="p-2">Name</th>
                  <th className="p-2">Phone</th>
                  <th className="p-2">Product</th>
                  <th className="p-2">TrxID</th>
                  <th className="p-2">Payment</th>
                  <th className="p-2">Paid</th>
                  <th className="p-2">Confirmed</th>
                  <th className="p-2">Date</th>
                  <th className="p-2">Actions</th>
                </tr>
              </thead>
              <tbody>
                {orders.map((order, index) => (
                  <tr key={index} className="border-b">
                    <td className="p-2">{order.name}</td>
                    <td className="p-2">{order.phone}</td>
                    <td className="p-2">{order.product}</td>
                    <td className="p-2">{order.trxId}</td>
                    <td className="p-2">{order.paymentMethod}</td>
                    <td className="p-2">{order.paid ? "Yes" : "No"}</td>
                    <td className="p-2">{order.confirmed ? "Yes" : "No"}</td>
                    <td className="p-2">{new Date(order.date).toLocaleString()}</td>
                    <td className="p-2 space-y-1 flex flex-col">
                      <Button className="text-xs bg-green-500 hover:bg-green-600" onClick={() => togglePaymentStatus(index)}>
                        Toggle Paid
                      </Button>
                      <Button className="text-xs bg-yellow-500 hover:bg-yellow-600" onClick={() => toggleConfirmation(index)}>
                        Toggle Confirm
                      </Button>
                      <Button className="text-xs bg-red-500 hover:bg-red-600" onClick={() => handleDeleteOrder(index)}>
                        Delete
                      </Button>
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        )}
      </section>

      <footer className="mt-12 border-t pt-6 text-center text-sm text-gray-500">
        <p>Send payment to: <strong>01941222010</strong> via bKash, Nagad, Rocket, or Upay</p>
        <p>Contact: <strong>01941222010</strong></p>
        <p>&copy; 2025 SS FASHION HOUSE. All rights reserved.</p>
      </footer>
    </main>
  );
}